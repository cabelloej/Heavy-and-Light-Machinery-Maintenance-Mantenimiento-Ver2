***
*** ACTUALIZA tablas varias
***
PUSH KEY CLEAR
DEFI WIND WINDTAB FROM wlin,wcol TO wlin+10,wcol+55;
          TITLE WTITLE;
          FOOTER " F1=Inc, F2=Mod, F3=Eli, F4=Bus, Enter=Salir " ;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINDTAB
ON KEY LABEL F1  DO PROTABI
ON KEY LABEL F2  DO PROTABM
ON KEY LABEL F3  DO PROTABE
ON KEY LABEL F4  DO PROTABB
ON KEY LABEL ENTER KEYBOARD '{CTRL+W}'
BROWSE FIELDS CODIGO:H="Codigo",DESCRI:H="Descripcion";
       NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW WINDTAB
DEACT WIND WINDTAB
POP KEY
RETURN

************
PROC PROTABI
************
PUSH KEY CLEAR
STORE "INCLUIR" TO WFLAGRTAB
SCATT MEMV BLANK
DO WHILE .T.
   STORE SPACE(LEN(M.DESCRI)) TO M.DESCRI
   DO GETTAB
   IF LASTKEY()=27
      EXIT
   ENDIF
ENDDO
POP KEY
RETURN

************
PROC PROTABM
************
PUSH KEY CLEAR
STORE "MODIFICAR" TO WFLAGRTAB
IF .NOT. EOF()
   SCATT MEMV
   DO GETTAB
ENDIF
POP KEY
RETURN

************
PROC PROTABE
************
IF EOF()
   RETURN
ENDIF
PUSH KEY CLEAR
STORE "ELIMINAR" TO WFLAGRTAB
STORE 2 TO WOP
DO CANCACEP WITH WFLAGRTAB
IF WOP=2
   IF RECLOC()
      DELETE
      UNLOCK
   ELSE
      DO PROCNUL
   ENDIF
ENDIF
POP KEY
RETURN

************
PROC PROTABB
************
PUSH KEY CLEAR
STORE "BUSCAR" TO WFLAGRTAB
DEFI WIND WINDBUS FROM 12,35 TO 14,75;
          TITLE  WFLAGRTAB ;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINDBUS
DO WHILE .T.
   SCATT MEMV BLANK
   @ 0,1 GET M.CODIGO
   READ
   IF LASTKEY()=27
      EXIT
   ENDIF
   IF M.CODIGO<>SPACE(LEN(M.CODIGO))
      SEEK M.CODIGO
      IF FOUND()
         EXIT
      ELSE
         STORE "NO REGISTRADO, REINTENTE" TO WTEXT
         DO AVISO WITH WTEXT
         LOOP
      ENDIF
   ENDIF
ENDDO
RELE WIND WINDBUS
POP KEY
RETURN

***********
PROC GETTAB
***********
DEFI WIND WINDGETT FROM WLIN+1,WCOL TO WLIN+4,WCOL+55;
          TITLE  WFLAGRTAB ;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINDGETT
DO WHILE .T.
   @ 00,01 SAY "Codigo.....:"
   @ 01,01 SAY "Descripcion:"
   IF WFLAGRTAB="INCLUIR"
      @ 0,14 GET M.CODIGO
      READ
      IF LASTKEY()=27
         EXIT
      ENDIF
      SEEK M.CODIGO
      IF FOUND()
         @ 1,14 SAY DESCRI
         STORE "CODIGO YA EXISTE" TO WTEXT
         DO AVISO WITH WTEXT
         LOOP
      ENDIF
   ELSE
      @ 0,14 SAY M.CODIGO
   ENDIF
   @ 1,14   GET M.DESCRI VALID VALDES()
   READ
   IF LASTKEY()=27
      EXIT
   ENDIF
   STORE 1 TO WOP
   DO ACEPCANC WITH WFLAGRTAB
   IF WOP=1
      IF WFLAGRTAB="INCLUIR"
         IF FILLOC()
            APPEND BLANK
            GATH MEMV
            UNLOCK ALL
         ELSE
           DO PROCNUL
         ENDIF
      ELSE
         IF RECLOC()
            GATH MEMV
            UNLOCK ALL
         ELSE
            DO PROCNUL
         ENDIF
      ENDIF
   ENDIF
   EXIT
ENDDO
RELE WIND WINDGETT
RETURN

***********
FUNC VALDES
***********
IF M.DESCRI<>SPACE(LEN(M.DESCRI))
   RETURN .T.
ELSE
   RETURN .F.
ENDIF


