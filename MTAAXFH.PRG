***
***  HISTORICO DE ACTIVIDADES EJECUTADAS
***
PUSH KEY CLEAR
DEFI WIND WINDAXFC FROM 03,00 TO 14,79;
          TITLE "< HISTORICO DE ACTIVIDADES EJECUTADAS "+ALLTRIM(MTFIC.CODFIC)+" >" ;
          FOOTER " Tab=Des, Ent=Sal " ;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
DEFI WIND WINDOBS FROM 15,00 TO 22,79;
          TITLE "< OBSERVACIONES >" ;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINDOBS
ACTI WIND WINDAXFC
ON KEY LABEL ENTER KEYBOARD '{CTRL+W}'
SELECT MTAXFH
SET ORDER TO MTAXFHS

BROWSE FIELDS FECEJE           :H='Fec ejec.',;
              USOEJE           :H='Uso ejec.',;
              WDESSEC=FUNDESS():H='Seccion',  ;
              CODPLA           :H='Plan',;
              WDESACT=FUNDESA():H='Actividad',;
              COSTO            :H='Costo est.',;
              FECREG           :H='Fec.aver.',;
              FECPRO           :H='Fec prog.',;
              USOPRO           :H='Uso prog.';
       NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW WINDAXFC;
       KEY MTFIC.CODFIC;
       WHEN WINOBS()
DEACT WIND WINDOBS
DEACT WIND WINDAXFC
POP KEY
RETURN

***********
PROC WINOBS
***********
ACTI WIND WINDOBS
@ 0,1 SAY MTAXFH.OBSERVA1+MTAXFH.OBSERVA2
@ 1,1 SAY MTAXFH.OBSERVA3+MTAXFH.OBSERVA4
@ 2,1 SAY MTAXFH.OBSERVA5+MTAXFH.OBSERVA6
ACTI WIND WINDAXFC
RETURN

************
FUNC FUNDESP
************
SELECT MTPLA
SEEK MTAXFH.CODCAT+MTAXFH.CODPLA
IF FOUND()
   STORE ALLTRIM(CODPLA)+" "+DESPLA TO WDESPLA
   STORE TIPO                       TO WTIPPLA
ELSE
   STORE "?"                        TO WDESPLA
   STORE TIPO                       TO WTIPPLA
ENDIF
SELECT MTAXFH
RETURN WDESPLA

************
FUNC FUNDESS
************
SELECT MTSEC
SEEK MTAXFH.CODCAT+MTAXFH.CODSEC
IF FOUND()
   STORE SUBSTR(DESSEC,1,25) TO WDESSEC
ELSE
   STORE "?"                 TO WDESSEC
ENDIF
SELECT MTAXFH
RETURN WDESSEC

************
FUNC FUNDESA
************
SELECT MTACT
IF ORDER()="MTACTXS"
   STORE MTAXFH.CODCAT+MTAXFH.CODSEC+MTAXFH.CODPLA+MTAXFH.CODACT    TO WCLAVEACT
ELSE
   IF ORDER()="MTACTXP"
      STORE MTAXFH.CODCAT+MTAXFH.CODPLA+MTAXFH.CODSEC+MTAXFH.CODACT TO WCLAVEACT
   ENDIF
ENDIF
SEEK WCLAVEACT
IF FOUND()
   STORE DESACT1+" "+;
         DESACT2+" "+;
         DESACT3+" "+;
         DESACT4+" "+;
         DESACT5       TO WDESACT1
ELSE
   STORE "?"           TO WDESACT1
ENDIF
SELECT MTAXFH
RETURN WDESACT1

