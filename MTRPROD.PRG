cHaving = ""  
IF EMPTY(WCODFIC)
   CHAVING= "!EMPTY(MTAXF.CODFIC)"
ELSE
   CHAVING= "MTAXF.CODFIC = WCODFIC"
ENDIF
IF !EMPTY(WDESDE)
   CHAVING = CHAVING+ " .AND. BETWEEN(MTAXF.FECPRO,WDESDE,WHASTA)"
ENDIF
 SELECT MTAXF.CODFIC, MTAXF.CODSEC, MTAXF.CODPLA,MTAXF.CODACT,MTAXF.CODCAT,MTAXF.FECPRO, MTAXF.USOPRO, MTAXF.COSTO,;
  MTACT.DESACT1,MTACT.DESACT2,MTACT.DESACT3,MTACT.DESACT4,MTACT.DESACT5,;
   MTSEC.DESSEC ;
    FROM MTAXF,MTACT,MTSEC ;
     WHERE MTAXF.CODCAT+MTAXF.CODSEC+MTAXF.CODACT = MTACT.CODCAT+MTACT.CODSEC+MTACT.CODACT ;
      AND MTAXF.CODCAT+MTAXF.CODSEC = MTSEC.CODCAT+MTSEC.CODSEC;
       HAVING &cHaving ;
        ORDER BY MTAXF.CODFIC,MTAXF.CODCAT,MTAXF.CODPLA,MTAXF.CODSEC,MTAXF.CODACT ;
         INTO CURSOR XPEPE
SELECT XPEPE
IF WSALIDA = 1
   report form MTRGEN PREVIEW 
ELSE
   report form MTRGEN TO PRINTER
ENDIF
SELECT XPEPE
USE

