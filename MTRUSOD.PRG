cHaving = ""  
IF EMPTY(WCODFIC)
   CHAVING= "!EMPTY(MTAXF.CODFIC) .AND. MTAXF.USOPRO>0 .AND. MTFIC.USOOPE >= MTAXF.USOPRO"
ELSE
   CHAVING= "MTAXF.CODFIC = WCODFIC .AND. MTAXF.USOPRO>0 .AND. MTFIC.USOOPE >= MTAXF.USOPRO"
ENDIF
 SELECT MTAXF.CODFIC, MTAXF.CODSEC, MTAXF.CODPLA,MTAXF.CODACT,MTAXF.CODCAT,MTAXF.FECPRO, MTAXF.USOPRO, MTAXF.COSTO,;
  MTACT.DESACT1,MTACT.DESACT2,MTACT.DESACT3,MTACT.DESACT4,MTACT.DESACT5,;
   MTSEC.DESSEC, MTFIC.USOOPE;
    FROM MTAXF,MTACT,MTSEC,MTFIC;
     WHERE MTAXF.CODCAT+MTAXF.CODSEC+MTAXF.CODACT = MTACT.CODCAT+MTACT.CODSEC+MTACT.CODACT ;
      AND MTAXF.CODCAT+MTAXF.CODSEC = MTSEC.CODCAT+MTSEC.CODSEC;
       AND MTFIC.CODFIC=MTAXF.CODFIC;
        HAVING &cHaving ;
         ORDER BY MTAXF.CODFIC,MTAXF.CODCAT,MTAXF.CODPLA,MTAXF.CODSEC,MTAXF.CODACT ;
          INTO CURSOR XPEPE
SELECT XPEPE
IF WSALIDA = 1
   report form MTRGEN PREVIEW 
ELSE
   report form MTRGEN TO PRINTER
ENDIF
SELECT XPEPE
USE

